<!-- Add this widget to your order dashboard or main dashboard -->
<!-- orders/templates/order/widgets/inventory_update_widget.html -->

<div class="card border-warning mb-4">
    <div class="card-header bg-warning bg-opacity-10">
        <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
                <i class="bi bi-box-seam text-warning me-2"></i>Pending Inventory Updates
            </h5>
            <a href="{% url 'inventory_update_dashboard' %}" class="btn btn-sm btn-warning">
                Manage <i class="bi bi-arrow-right ms-1"></i>
            </a>
        </div>
    </div>
    <div class="card-body">
        {% if inventory_update_needed > 0 %}
        <div class="alert alert-warning mb-3">
            <i class="bi bi-exclamation-triangle me-2"></i>
            <strong>{{ inventory_update_needed }}</strong> completed order{{ inventory_update_needed|pluralize }} 
            waiting for inventory update
        </div>
        
        <div class="d-grid gap-2">
            <a href="{% url 'inventory_update_dashboard' %}" class="btn btn-outline-primary">
                <i class="bi bi-list-ul me-2"></i>View Details
            </a>
            <a href="{% url 'product_wise_inventory' %}" class="btn btn-outline-primary">
                <i class="bi bi-grid-3x3-gap me-2"></i>Product View
            </a>
            <button onclick="quickBulkUpdate()" class="btn btn-success">
                <i class="bi bi-lightning-charge-fill me-2"></i>Update All Now
            </button>
        </div>
        {% else %}
        <div class="text-center py-3">
            <i class="bi bi-check-circle text-success fs-2 d-block mb-2"></i>
            <p class="text-muted mb-0">All inventory is up to date!</p>
        </div>
        {% endif %}
    </div>
</div>

<script>
function quickBulkUpdate() {
    if (!confirm('Update inventory for all pending orders? This action cannot be undone.')) {
        return;
    }
    
    fetch('{% url "bulk_update_inventory" %}', {
        method: 'POST',
        headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert(`✓ Success!\n\nUpdated ${data.orders_updated} orders\n${data.items_updated} items processed`);
            location.reload();
        } else {
            alert('❌ Error: ' + data.message);
        }
    })
    .catch(error => {
        alert('Error: ' + error);
    });
}
</script>